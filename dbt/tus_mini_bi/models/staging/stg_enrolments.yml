version: 2

models:
  - name: stg_enrolments
    description: "Cleaned enrolment records from raw.enrolments (minimal grain fields)"
    columns:
      - name: student_id
        tests: [not_null]
      - name: programme_id
        tests: [not_null]
      - name: academic_year
        tests: [not_null]
      - name: year_of_study
        tests: [not_null]
      - name: registration_status
        tests:
          - not_null
          - accepted_values:
              arguments:
               values: ['Registered', 'Withdrawn', 'Deferred', 'Unknown']
      - name: entrant_flag
        tests:
          - accepted_values:
              arguments:
               values: [0, 1]